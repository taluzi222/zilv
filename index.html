<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è‡ªå¾‹ç®¡ç†ç³»ç»Ÿ - æœ€ç»ˆä¿®å¤ç‰ˆ</title>
    <style>
        /* åŸºç¡€æ ·å¼ */
        body { font-family: 'å¾®è½¯é›…é»‘', sans-serif; margin: 0; padding: 0; background: #f5f8fa; color: #333; display: flex; flex-direction: column; align-items: center; min-height: 100vh; }
        .container { width: 90%; max-width: 800px; padding: 1rem; background: white; border-radius: 15px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05); margin-top: 1rem; text-align: center; }
        h2, h3 { color: #2c3e50; text-align: center; }
        #dateDisplay { font-size: 1.1rem; color: #555; margin-bottom: 1rem; }
        .progress { background: #ecf3f8; padding: 1rem; border-radius: 10px; margin-bottom: 1.5rem; text-align: center; }
        .progress p { margin: 0.5rem 0; }
        .challenge-status { display: flex; justify-content: space-around; align-items: center; margin-bottom: 1rem; }
        .challenge-status.single { justify-content: center; }
        .status-item { padding: 0.5rem 1rem; border-radius: 8px; font-weight: bold; }
        .success-item { background: #d4edda; color: #155724; }
        .failure-item { background: #f8d7da; color: #721c24; }
        button { background: #3498db; color: white; padding: 0.8rem 1.5rem; border: none; border-radius: 8px; cursor: pointer; margin: 0.3rem; font-size: 1rem; transition: background-color 0.3s ease, transform 0.2s ease; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1); }
        button:hover { background: #2980b9; transform: scale(1.05); }
        button:active { transform: translateY(2px) scale(1.05); box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1); }
        #breakButton { background: #e74c3c; }
        #breakButton:hover { background: #c0392b; }
        #motivation, #breakMessage { font-size: 1.3rem; margin: 1.5rem 0; text-align: center; font-weight: bold; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1); }
        #motivation { color: #27ae60; }
        #breakMessage { color: #e67e22; }
        .strategy-box { background: #fffde7; padding: 1.2rem; border-left: 5px solid #f1c40f; border-radius: 8px; margin-bottom: 1.5rem; text-align: center; }
        .strategy-box h3 { text-align: left; }
        #breathCircle { width: 100px; height: 100px; border-radius: 50%; background: #87CEEB; margin: 1rem auto; display: none; animation: breathe 6s ease-in-out infinite; opacity: 0.5; }
        @keyframes breathe { 0% { transform: scale(0.8); opacity: 0.5; } 50% { transform: scale(1.2); opacity: 1; } 100% { transform: scale(0.8); opacity: 0.5; } }
        #breathTimer { text-align: center; margin-top: 1rem; }
        #activity { margin-top: 0.5rem; text-align: center; font-style: italic; color: #777; }
        #thumbsUp { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0); font-size: 8rem; opacity: 0; z-index: 1000; pointer-events: none;}
        @keyframes thumbsUpAnim { 0% { transform: translate(-50%, -50%) scale(0); opacity: 0; } 50% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; } 100% { transform: translate(-50%, -50%) scale(1); opacity: 0; } }
        #statsModal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.7); z-index: 999; overflow: auto; }
        .modal-content { background: white; width: 80%; max-width: 600px; margin: 5% auto; padding: 2rem; border-radius: 15px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2); position: relative; }
        .close-button { position: absolute; top: 1rem; right: 1rem; font-size: 1.5rem; cursor: pointer; color: #999; }
        .close-button:hover { color: #333; }
        #calendar { width: 100%; border-collapse: collapse; margin-top: 1rem; }
        #calendar th, #calendar td { border: 1px solid #ddd; padding: 0.4rem; text-align: center; }
        #calendar th { background: #f0f0f0; font-weight: bold; }
        #calendar td.success { background: #dff0d8; }
        #calendar td.failure { background: #dc3545; color: white; }
        #calendar td.no-failure { background: #eee; }
        #streakInfo { margin-top: 1rem; font-size: 1.1rem; }
        .footer { margin-top: auto; padding: 1rem; color: #666; font-size: 0.9rem; text-align: center; }
        .footer ul { list-style: none; padding: 0; }
        #loading { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255, 255, 255, 0.8); display: flex; justify-content: center; align-items: center; z-index: 1000; font-size: 1rem; pointer-events: none;}
    </style>
</head>
<body>
    <div id="loading">é¡µé¢åŠ è½½ä¸­,è¯·ç¨ç­‰...</div>
    <div id="thumbsUp">ğŸ‘</div>
    <div id="statsModal">
        <div class="modal-content">
            <span class="close-button" onclick="closeStatsModal()">Ã—</span>
            <h2>æœˆåº¦è‡ªå¾‹ç»Ÿè®¡</h2>
            <h3 id="currentMonth"></h3>
            <table id="calendar">
                <thead><tr><th>æ—¥</th><th>ä¸€</th><th>äºŒ</th><th>ä¸‰</th><th>å››</th><th>äº”</th><th>å…­</th></tr></thead>
                <tbody></tbody>
            </table>
            <div id="streakInfo"></div>
        </div>
    </div>
    <div class="container">
        <h2>ğŸ† è‡ªå¾‹æˆå°±ç³»ç»Ÿ</h2>
        <div id="dateDisplay"></div>
        <div class="progress">
          <div class="challenge-status">
            <div class="status-item success-item">ä»Šæ—¥æŒ‘æˆ˜æˆåŠŸï¼š<span id="todaySuccessCount">0</span> æ¬¡</div>
            <div class="status-item failure-item" style="display: none;" id="failureItem">ä»Šæ—¥æŒ‘æˆ˜å¤±è´¥ï¼š<span id="todayFailureCount">0</span> æ¬¡</div>
          </div>
            <p>æŒç»­è‡ªå¾‹å¤©æ•°ï¼š<span id="days">0</span> å¤©</p>
            <p>æœ¬å‘¨æˆåŠŸæ¬¡æ•°ï¼š<span id="weekly">0</span>/7</p>
            <button id="recordButton">â° è‡ªå¾‹ç­¾åˆ°</button>
        </div>
        <div id="motivation"></div>
        <div id="breakMessage" style="display: none;"></div>
        <div class="strategy-box">
            <h3>ğŸ›¡ï¸ å³æ—¶é˜²å¾¡ç­–ç•¥</h3>
            <p>å½“æ¸´æœ›å‡ºç°æ—¶ï¼š</p>
            <button id="activityButton">ğŸš€ è·å–æ›¿ä»£æ´»åŠ¨</button>
            <button id="breathingButton">ğŸ§˜ å¼€å§‹å‘¼å¸ç»ƒä¹ </button>
            <p id="activity"></p>
            <div id="breathTimer" style="display:none;"><p>æ·±å‘¼å¸å€’è®¡æ—¶ï¼š<span id="countdown">60</span>ç§’</p></div>
            <div id="breathCircle"></div>
        </div>
        <div class="strategy-box">
            <h3>ğŸ“Š æˆå°±å¯è§†åŒ–</h3>
            <p>å·²èŠ‚çœæ—¶é—´ï¼š<span id="savedHours">0</span> åˆ†é’Ÿ</p>
            <p>å¥åº·æŒ‡æ•°ï¼š<span id="healthIndex">0</span>%</p>
        </div>
        <button id="statsButton">ğŸ“… æœˆè‡ªå¾‹ç»Ÿè®¡</button>
        <button id="breakButton">ğŸ’” ç ´æˆ’</button>
      </div>
    <div class="footer">
        <hr>
        <p>ç§‘å­¦ä¾æ®ï¼š<ul><li>21å¤©ä¹ æƒ¯å…»æˆç†è®º</li><li>å†²åŠ¨è½¬ç§»æ³•</li><li>æ­£å¿µå‘¼å¸ç»ƒä¹ </li></ul></p>
        <p>éšç§è¯´æ˜ï¼šæ‰€æœ‰æ•°æ®ä»…å­˜å‚¨åœ¨æœ¬åœ°æµè§ˆå™¨</p>
    </div>
    <audio id="breathAudio" src="breath.mp3" loop></audio>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // ---------- DOM å…ƒç´  ----------
        const daysDisplay = document.getElementById('days');
        const weeklyDisplay = document.getElementById('weekly');
        const savedHoursDisplay = document.getElementById('savedHours');
        const healthIndexDisplay = document.getElementById('healthIndex');
        const motivationDisplay = document.getElementById('motivation');
        const breakMessageDisplay = document.getElementById('breakMessage');
        const activityDisplay = document.getElementById('activity');
        const breathTimerDisplay = document.getElementById('breathTimer');
        const countdownDisplay = document.getElementById('countdown');
        const breathCircle = document.getElementById('breathCircle');
        const breathAudio = document.getElementById('breathAudio');
        const loading = document.getElementById("loading");
        const recordButton = document.getElementById('recordButton');
        const activityButton = document.getElementById('activityButton');
        const breathingButton = document.getElementById('breathingButton');
        const breakButton = document.getElementById('breakButton');
        const statsButton = document.getElementById('statsButton');
        const statsModal = document.getElementById('statsModal');
        const currentMonthDisplay = document.getElementById('currentMonth');
        const calendarBody = document.getElementById('calendar').getElementsByTagName('tbody')[0];
        const streakInfoDisplay = document.getElementById('streakInfo');
        const thumbsUp = document.getElementById('thumbsUp');
        const todaySuccessCountDisplay = document.getElementById('todaySuccessCount');
        const failureItemDisplay = document.getElementById('failureItem');
        const todayFailureCountDisplay = document.getElementById('todayFailureCount');
        const challengeStatus = document.querySelector('.challenge-status');
        const dateDisplay = document.getElementById('dateDisplay');
        const closeButton = document.querySelector('.close-button'); // è·å–å…³é—­æŒ‰é’®
        let breathInterval;
        let countdownValue = 60;

        // ---------- æ•°æ® ----------
        const START_DATE = new Date('2023-01-01'); // å›ºå®šèµ·å§‹æ—¥æœŸ
        let data = {
            streak: 0,
            lastSuccessDay: 0, // ä¸Šæ¬¡æˆåŠŸæ—¥æœŸçš„å¤©æ•°è®¡æ•°å™¨
            weeklySuccess: 0,
            savedMinutes: 0,
            healthIndex: 0,
            dailyRecords: {}, // {"day": { success: 1, failure: 0 }}
        };

        // ---------- å·¥å…·å‡½æ•° ----------

        const loadData = () => {
            const storedData = localStorage.getItem('selfControlData');
            if (storedData) {
                data = JSON.parse(storedData);
            }
        };

        const saveData = () => {
            localStorage.setItem('selfControlData', JSON.stringify(data));
        };

        // è®¡ç®—ä»å›ºå®šèµ·å§‹æ—¥æœŸåˆ°ç»™å®šæ—¥æœŸçš„å¤©æ•°
        const getDayNumber = (date) => {
            return Math.floor((date - START_DATE) / (1000 * 60 * 60 * 24));
        };

        // è·å–ä»Šå¤©çš„ Date å¯¹è±¡ï¼ˆå·²æ ¡å‡†æ—¶é—´ï¼‰
        const getToday = () => {
            return new Date(parseInt(localStorage.getItem('calibratedTimestamp')));
        };

        // ---------- æ—¶é—´æ ¡å‡† ----------
        const getTime = async () => {
            const apiId = '10002866';
            const apiKey = 'ec90ba12096a04176621ba4a46d8f609';
            const baseUrl = "https://cn.apihz.cn/api/time/getapi.php";
            const controller = new AbortController();
            const timeoutId = setTimeout(() => controller.abort(), 5000);
            const apiUrl = `${baseUrl}?id=${apiId}&key=${apiKey}&type=1`;

            try {
                const response = await fetch(apiUrl, { signal: controller.signal });
                clearTimeout(timeoutId);
                if (!response.ok) { throw new Error(`HTTP é”™è¯¯! çŠ¶æ€ç : ${response.status}`); }
                const text = await response.text();
                const responseData = JSON.parse(text);
                if (responseData && responseData.msg) {
                    const timestamp = parseInt(responseData.msg, 10);
                    if (isNaN(timestamp)) { throw new Error(`è§£æå‡ºçš„æ—¶é—´æˆ³æ— æ•ˆ: ${responseData.msg}`); }
                    localStorage.setItem('calibratedTimestamp', timestamp * 1000);
                } else { throw new Error('API è¿”å›çš„æ•°æ®æ ¼å¼ä¸æ­£ç¡®');}
            } catch (error) {
                console.error('è·å–æ—¶é—´å¤±è´¥:', error);
                // ä½¿ç”¨æœ¬åœ°æ—¶é—´ä½œä¸ºå¤‡ç”¨æ–¹æ¡ˆ
                localStorage.setItem('calibratedTimestamp', Date.now());
            } finally {
                loading.style.display = 'none';
            }
        };

        // ---------- UI æ›´æ–° ----------

        const updateUI = () => {
            const today = getToday();
            const todayNumber = getDayNumber(today);

            daysDisplay.textContent = data.streak;
            weeklyDisplay.textContent = data.weeklySuccess;
            savedHoursDisplay.textContent = data.savedMinutes;
            healthIndexDisplay.textContent = data.healthIndex;

            // æ›´æ–°ä»Šæ—¥æŒ‘æˆ˜æˆåŠŸ/å¤±è´¥æ¬¡æ•°
            if (data.dailyRecords[todayNumber]) {
                todaySuccessCountDisplay.textContent = data.dailyRecords[todayNumber].success;
                todayFailureCountDisplay.textContent = data.dailyRecords[todayNumber].failure;
                if (data.dailyRecords[todayNumber].failure > 0) {
                    failureItemDisplay.style.display = 'flex';
                    challengeStatus.classList.remove('single');
                } else {
                    failureItemDisplay.style.display = 'none';
                    challengeStatus.classList.add('single');
                }
            } else {
                // ç†è®ºä¸Šä¸åº”è¯¥åˆ°è¿™é‡Œï¼Œä½†ä¸ºäº†å¥å£®æ€§ï¼Œè¿˜æ˜¯åŠ ä¸Š
                todaySuccessCountDisplay.textContent = '0';
                todayFailureCountDisplay.textContent = '0';
                failureItemDisplay.style.display = 'none';
                challengeStatus.classList.add('single');
            }

            // æ˜¾ç¤ºæ—¥æœŸ
            dateDisplay.textContent = today.toLocaleDateString('zh-CN', { year: 'numeric', month: 'long', day: 'numeric', weekday: 'long' });

            // æ›´æ–°æ¿€åŠ±æ–‡æ¡ˆï¼ˆåªåœ¨æœ‰æˆåŠŸè®°å½•æ—¶æ›´æ–°ï¼‰
            if (data.dailyRecords[todayNumber] && data.dailyRecords[todayNumber].success > 0) {
                motivationDisplay.textContent = positiveAffirmations[Math.floor(Math.random() * positiveAffirmations.length)];
            } else {
                motivationDisplay.textContent = "æ‚¨æ­£åœ¨åˆ›é€ æ›´å¥½çš„è‡ªå·±ï¼"; // é»˜è®¤æ–‡æ¡ˆ
            }
             // æ£€æŸ¥ä»Šå¤©æ˜¯å¦æ˜¯ç¬¬ä¸€æ¬¡ç‚¹å‡»ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™æ›´æ”¹æŒ‰é’®æ–‡å­—
            if (data.dailyRecords[todayNumber] && data.dailyRecords[todayNumber].success === 0) {
              recordButton.textContent = "â° è‡ªå¾‹ç­¾åˆ°"; // åˆå§‹æ–‡æœ¬
            }
        };

        // ---------- æ¯æ—¥é‡ç½® ----------
        const dailyReset = () => {
            const today = getToday();
            const todayNumber = getDayNumber(today);
            if (data.lastSuccessDay !== todayNumber) {
                data.weeklySuccess = 0; // é‡ç½®æ¯å‘¨æˆåŠŸæ¬¡æ•°
            }
            // å¦‚æœä»Šå¤©æ²¡æœ‰è®°å½•ï¼Œåˆ™åˆ›å»ºä¸€æ¡æ–°è®°å½•
            if (!data.dailyRecords[todayNumber]) {
                data.dailyRecords[todayNumber] = { success: 0, failure: 0 };
            }
            // é‡ç½®æŒ‰é’®æ–‡å­—
            recordButton.textContent = "â° è‡ªå¾‹ç­¾åˆ°";
        };

        // ---------- äº‹ä»¶å¤„ç† ----------

        const recordSuccess = () => {
            console.log('recordSuccess called'); // è°ƒè¯•ç”¨
            const today = getToday();
            const todayNumber = getDayNumber(today);

            if (data.lastSuccessDay !== todayNumber) {
                data.streak++;
                data.lastSuccessDay = todayNumber; // æ›´æ–°ä¸Šæ¬¡æˆåŠŸæ—¥æœŸ
            }
            data.weeklySuccess++;
            data.savedMinutes += 40;
            data.healthIndex = Math.min(data.healthIndex + 2, 100);
            data.dailyRecords[todayNumber].success++;

            saveData();
            // åˆ‡æ¢æ–‡æ¡ˆå’ŒæŒ‰é’®æ–‡å­—
            breakMessageDisplay.style.display = 'none'; // éšè—ç ´æˆ’æ–‡æ¡ˆ
            motivationDisplay.style.display = 'block'; // æ˜¾ç¤ºæ¿€åŠ±æ–‡æ¡ˆ
            motivationDisplay.textContent = positiveAffirmations[Math.floor(Math.random() * positiveAffirmations.length)];
            recordButton.textContent = "âœ… ä»Šæ—¥æŒ‘æˆ˜æˆåŠŸ"; // æ›´æ”¹æŒ‰é’®æ–‡å­—
            updateUI();
            showThumbsUp();
        };

        const handleBreak = () => {
            const today = getToday();
            const todayNumber = getDayNumber(today);

            data.streak = 0; // é‡ç½®è¿ç»­å¤©æ•°
            data.dailyRecords[todayNumber].failure++;

            breakMessageDisplay.textContent = breakAffirmations[Math.floor(Math.random() * breakAffirmations.length)];
            breakMessageDisplay.style.display = 'block';
            motivationDisplay.style.display = 'none';

            saveData();
            updateUI();
        };

        const showActivity = () => {
            console.log('showActivity called'); // è°ƒè¯•ç”¨
            // ç¡®ä¿ activities æ•°ç»„ä¸ä¸ºç©º
            if (activities.length > 0) {
                activityDisplay.textContent = activities[Math.floor(Math.random() * activities.length)];
            } else {
                activityDisplay.textContent = "æš‚æ— æ›¿ä»£æ´»åŠ¨";
            }
        };

        const startBreathing = () => {
            console.log('startBreathing called'); // è°ƒè¯•ç”¨
            resetBreathingUI();
            breathCircle.style.display = 'block';
            breathTimerDisplay.style.display = 'block';
            breathAudio.play();
            breathInterval = setInterval(() => {
                countdownValue--;
                countdownDisplay.textContent = countdownValue;
                if (countdownValue <= 0) { resetBreathingUI(); }
            }, 1000);
        };
        const resetBreathingUI = () => {
            clearInterval(breathInterval);
            breathAudio.pause();
            breathAudio.currentTime = 0;
            breathCircle.style.display = 'none';
            breathTimerDisplay.style.display = 'none';
            countdownValue = 60;
            countdownDisplay.textContent = countdownValue;
        };

        const showStatsModal = () => {
            const today = getToday();
            const year = today.getFullYear();
            const month = today.getMonth();
            showMonthStats(year, month);
            statsModal.style.display = 'block';
        };

        const closeStatsModal = () => {
            statsModal.style.display = 'none';
        };

        const showMonthStats = (year, month) => {
            currentMonthDisplay.textContent = `${year}å¹´${month + 1}æœˆ`;
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const firstDayOfWeek = new Date(year, month, 1).getDay();

            calendarBody.innerHTML = '';

            let date = 1;
            for (let i = 0; i < 6; i++) {
                const row = document.createElement('tr');
                for (let j = 0; j < 7; j++) {
                    if (i === 0 && j < firstDayOfWeek) {
                        row.appendChild(document.createElement('td'));
                    } else if (date > daysInMonth) {
                        break;
                    } else {
                        const cell = document.createElement('td');
                        const dateObject = new Date(year, month, date);
                        const dayNumber = getDayNumber(dateObject);
                        const record = data.dailyRecords[dayNumber] || { success: 0, failure: 0 };

                        cell.textContent = `${date} (âœ“${record.success}, âœ—${record.failure})`;

                        // æ·»åŠ  CSS ç±»
                        if (record.success > 0 && record.failure === 0) {
                            cell.classList.add('success');
                        } else if (record.failure > 0) {
                            cell.classList.add('failure');
                        } else {
                            cell.classList.add('no-failure'); // æ²¡æœ‰ç ´æˆ’è®°å½•çš„æ ·å¼
                        }

                        row.appendChild(cell);
                        date++;
                    }
                }
                calendarBody.appendChild(row);
            }

            const streaks = calculateStreaks(year, month);
            streakInfoDisplay.textContent = streaks.length > 0 ? `è¿ç»­è‡ªå¾‹æ—¶é—´æ®µï¼š${streaks.join('; ')}` : 'æœ¬æœˆæ²¡æœ‰è¿ç»­è‡ªå¾‹è®°å½•';
        };

        const calculateStreaks = (year, month) => {
            const streaks = [];
            let currentStreakStart = null;
            let currentStreakEnd = null;
            const startDate = new Date(year, month, 1);
            const endDate = new Date(year, month + 1, 0);
            const startDayNumber = getDayNumber(startDate);
            const endDayNumber = getDayNumber(endDate);

            for (let dayNumber = startDayNumber; dayNumber <= endDayNumber; dayNumber++) {
                const record = data.dailyRecords[dayNumber] || { success: 0, failure: 0 };

                if (record.success > 0 && record.failure === 0) {
                    if (!currentStreakStart) {
                        currentStreakStart = dayNumber;
                    }
                    currentStreakEnd = dayNumber;
                } else {
                    if (currentStreakStart) {
                        const startDate = new Date(START_DATE.getTime() + currentStreakStart * (24 * 60 * 60 * 1000));
                        const endDate = new Date(START_DATE.getTime() + currentStreakEnd * (24 * 60 * 60 * 1000));

                        const formattedStartDate = `${startDate.getFullYear()}-${String(startDate.getMonth() + 1).padStart(2, '0')}-${String(startDate.getDate()).padStart(2, '0')}`;
                        const formattedEndDate = `${endDate.getFullYear()}-${String(endDate.getMonth() + 1).padStart(2, '0')}-${String(endDate.getDate()).padStart(2, '0')}`;

                        streaks.push(`${formattedStartDate} è‡³ ${formattedEndDate}`);
                        currentStreakStart = null;
                        currentStreakEnd = null;
                    }
                }
            }

            if (currentStreakStart) {
                const startDate = new Date(START_DATE.getTime() + currentStreakStart * (24 * 60 * 60 * 1000));
                const endDate = new Date(START_DATE.getTime() + currentStreakEnd * (24 * 60 * 60 * 1000));
                const formattedStartDate = `${startDate.getFullYear()}-${String(startDate.getMonth() + 1).padStart(2, '0')}-${String(startDate.getDate()).padStart(2, '0')}`;
                const formattedEndDate = `${endDate.getFullYear()}-${String(endDate.getMonth() + 1).padStart(2, '0')}-${String(endDate.getDate()).padStart(2, '0')}`;
                streaks.push(`${formattedStartDate} è‡³ ${formattedEndDate}`);
            }
            return streaks;
        };

        const showThumbsUp = () => {
            thumbsUp.style.animation = 'none';
            void thumbsUp.offsetWidth;
            thumbsUp.style.animation = null;
            thumbsUp.style.animation = 'thumbsUpAnim 1.5s forwards';
        };

        // ---------- æ–‡æ¡ˆåº“ ----------

        // 30ç»„æ­£å‘æ¿€åŠ±æ–‡æ¡ˆ
        const positiveAffirmations = [
            "å¤ªæ£’äº†ï¼Œä½ åˆæˆ˜èƒœäº†ä¸€æ¬¡æŒ‘æˆ˜ï¼", "ä½ çš„è‡ªå¾‹ä»¤äººé’¦ä½©ï¼", "æ¯ä¸€æ­¥ï¼Œéƒ½åœ¨æ¥è¿‘æ›´å¥½çš„è‡ªå·±ï¼", "ä½ æ­£åœ¨ä¹¦å†™å±äºä½ çš„æˆåŠŸæ•…äº‹ï¼", "åšæŒä¸‹å»ï¼Œä½ ä¼šçœ‹åˆ°æƒŠäººçš„æ”¹å˜ï¼", "ä½ æ˜¯è‡ªå¾‹çš„å…¸èŒƒï¼", "ä½ çš„åŠªåŠ›ï¼Œæ—¶é—´ä¼šç»™ä½ ç­”æ¡ˆï¼", "ç›¸ä¿¡è‡ªå·±ï¼Œä½ å¯ä»¥åšåˆ°ï¼", "å°å°çš„è¿›æ­¥ï¼Œç´¯ç§¯æˆå¤§å¤§çš„æˆåŠŸï¼", "ä½ æ¯”ä½ æƒ³è±¡çš„æ›´å¼ºå¤§ï¼", "è‡ªå¾‹ï¼Œæ˜¯é€šå¾€è‡ªç”±çš„æ¡¥æ¢ï¼", "ä½ æ­£åœ¨å¡‘é€ ä¸€ä¸ªå…¨æ–°çš„è‡ªå·±ï¼", "ä½ çš„åšæŒï¼Œç»ˆå°†é—ªè€€ï¼", "æ¯ä¸€æ­¥ï¼Œéƒ½ç®—æ•°ï¼", "ä½ æ­£åœ¨æˆä¸ºä½ æƒ³è¦æˆä¸ºçš„äººï¼", "è‡ªå¾‹ï¼Œæ˜¯æœ€å¥½çš„ç¤¼ç‰©ï¼", "ä½ çš„åŠªåŠ›ï¼Œä¸ä¼šè¢«è¾œè´Ÿï¼", "åšæŒï¼Œå°±æ˜¯èƒœåˆ©ï¼", "ä½ æ­£åœ¨åˆ›é€ å¥‡è¿¹ï¼", "ä½ çš„è¿›æ­¥ï¼Œå€¼å¾—åº†ç¥ï¼", "è‡ªå¾‹ï¼Œè®©ç”Ÿæ´»æ›´ç¾å¥½ï¼", "ä½ æ­£åœ¨è¶…è¶Šæ˜¨å¤©çš„è‡ªå·±ï¼", "æ¯ä¸€å¤©ï¼Œéƒ½æ˜¯æ–°çš„å¼€å§‹ï¼", "ä½ çš„æ½œåŠ›ï¼Œæ— é™å¯èƒ½ï¼", "è‡ªå¾‹ï¼Œæ˜¯æˆåŠŸçš„åŸºçŸ³ï¼", "ä½ æ­£åœ¨åˆ›é€ å±äºä½ çš„è¾‰ç…Œï¼", "åšæŒä¸‹å»ï¼Œä½ ä¼šæ„Ÿè°¢ä»Šå¤©çš„è‡ªå·±ï¼", "ä½ çš„åŠªåŠ›ï¼Œç»ˆå°†å¼€èŠ±ç»“æœï¼", "è‡ªå¾‹ï¼Œæˆå°±éå‡¡ï¼", "ä½ æ­£åœ¨èµ°å‘æ›´ç¾å¥½çš„æœªæ¥ï¼"
        ];
        // 10ç»„ç ´æˆ’å®‰æ…°+é¼“åŠ±+é­ç­–æ–‡æ¡ˆ
        const breakAffirmations = [
          "æ²¡å…³ç³»ï¼Œä¸€æ¬¡å¤±è¯¯ä¸ä»£è¡¨å¤±è´¥ï¼Œé‡æ–°æŒ¯ä½œèµ·æ¥ï¼", "è·Œå€’äº†å°±çˆ¬èµ·æ¥ï¼Œç»§ç»­å‰è¿›ï¼Œä½ æ¯”æ˜¨å¤©æ›´åšå¼ºï¼", "åˆ«ç°å¿ƒï¼Œæ¯ä¸€æ¬¡æŒ«æŠ˜éƒ½æ˜¯æˆé•¿çš„æœºä¼šã€‚", "æ¥å—ä¸å®Œç¾ï¼Œä½†æ°¸ä¸æ”¾å¼ƒè¿½æ±‚å“è¶Šã€‚", "ä»é”™è¯¯ä¸­å­¦ä¹ ï¼Œä¸‹ä¸€æ¬¡ä½ ä¼šåšå¾—æ›´å¥½ï¼", "è°ƒæ•´å¿ƒæ€ï¼Œé‡æ–°å‡ºå‘ï¼Œä½ ä¾ç„¶å¯ä»¥æŒæ§è‡ªå·±ï¼", "ç»™è‡ªå·±ä¸€ä¸ªæ‹¥æŠ±ï¼Œç„¶åç»§ç»­æŒ‘æˆ˜ï¼", "è®°ä½ä½ çš„ç›®æ ‡ï¼Œä¸è¦è®©ä¸€æ—¶çš„å¤±è¯¯é˜»æŒ¡ä½ ã€‚", "å¤±è´¥æ˜¯æˆåŠŸä¹‹æ¯ï¼Œæ¯ä¸€æ¬¡å°è¯•éƒ½è®©ä½ æ›´æ¥è¿‘æˆåŠŸã€‚", "é­ç­–è‡ªå·±ï¼Œä½†ä¹Ÿè¦å–„å¾…è‡ªå·±ï¼Œä½ æ˜¯æœ€æ£’çš„ï¼"
        ];

          // 20ç§è¡Œä¸ºæ›¿ä»£æ–¹æ¡ˆ
          const activities = [
            "ğŸƒ åš20ä¸ªå¼€åˆè·³ï¼Œæ¿€æ´»èº«ä½“ï¼", "ğŸ“– é˜…è¯»10é¡µä½ å–œæ¬¢çš„ä¹¦ç±ï¼Œæ»‹å…»å¿ƒçµã€‚", "ğŸ§¹ èŠ±10åˆ†é’Ÿæ•´ç†ä½ çš„ä¹¦æ¡Œæˆ–æˆ¿é—´ä¸€è§’ã€‚", "ğŸš¶ å»æˆ·å¤–å¿«èµ°15åˆ†é’Ÿï¼Œå‘¼å¸æ–°é²œç©ºæ°”ã€‚", "ğŸ’§ å–ä¸€å¤§æ¯æ¸©æ°´ï¼Œè¡¥å……æ°´åˆ†ã€‚", "ğŸ§˜â€ åš5åˆ†é’Ÿå†¥æƒ³ï¼Œå¹³é™å†…å¿ƒã€‚", "ğŸ¶ å¬ä¸€é¦–ä½ æœ€å–œæ¬¢çš„æ­Œæ›²ï¼Œæ”¾æ¾å¿ƒæƒ…ã€‚", "âœï¸ å†™ä¸‹3ä»¶ä½ æ„Ÿæ¿€çš„äº‹æƒ…ã€‚", "ğŸŒ± ç…§é¡¾ä¸€ä¸‹ä½ çš„æ¤ç‰©ï¼Œæ„Ÿå—ç”Ÿå‘½åŠ›ã€‚", "ğŸ åƒä¸€ä¸ªè‹¹æœæˆ–ä½ å–œæ¬¢çš„æ°´æœã€‚", "ğŸ’ª åšä¸€ç»„ä½ æ“…é•¿çš„åŠ›é‡è®­ç»ƒï¼ˆå¦‚ä¿¯å§æ’‘ã€æ·±è¹²ï¼‰ã€‚", "ğŸ§  ç©ä¸€ä¸ªç›Šæ™ºå°æ¸¸æˆï¼Œé”»ç‚¼å¤§è„‘ã€‚", "ğŸ¨ éšæ„æ¶‚é¸¦å‡ ç¬”ï¼Œé‡Šæ”¾åˆ›é€ åŠ›ã€‚", "ğŸ“ ç»™ä¸€ä½æœ‹å‹æˆ–å®¶äººæ‰“ä¸ªç®€çŸ­çš„ç”µè¯ã€‚", "ğŸ“ åˆ—å‡ºä»Šå¤©/æ˜å¤©æœ€é‡è¦çš„3ä»¶äº‹ã€‚", "ğŸ“š å­¦ä¹ ä¸€ä¸ªæ–°çš„å°æŠ€èƒ½ï¼ˆå¦‚ä¸€ä¸ªæ–°å•è¯ã€ä¸€ä¸ªæ–°æ¦‚å¿µï¼‰ã€‚", "ğŸŒ³ è§‚å¯Ÿçª—å¤–çš„æ ‘æœ¨æˆ–å¤©ç©º5åˆ†é’Ÿã€‚", "ğŸ˜Š å¯¹ç€é•œå­å¾®ç¬‘2åˆ†é’Ÿã€‚", "ğŸ™ åš5åˆ†é’Ÿæ‹‰ä¼¸è¿åŠ¨ï¼Œæ”¾æ¾è‚Œè‚‰ã€‚", "ğŸ“° æµè§ˆæ–°é—»æ ‡é¢˜ï¼Œäº†è§£æ—¶äº‹ï¼ˆä½†é¿å…æ²‰è¿·ï¼‰ã€‚"
          ];

        // ---------- åˆå§‹åŒ– ----------

        const initApp = async () => {
            await getTime();       // è·å–æ ¡å‡†æ—¶é—´
            loadData();           // åŠ è½½æ•°æ®
            dailyReset();         // æ‰§è¡Œæ¯æ—¥é‡ç½®
            updateUI();           // æ›´æ–° UI

            // æ³¨å†Œäº‹ä»¶ç›‘å¬å™¨ (åœ¨åˆå§‹åŒ–å®Œæˆå)
            recordButton.addEventListener('click', recordSuccess);
            breakButton.addEventListener('click', handleBreak);
            activityButton.addEventListener('click', showActivity);
            breathingButton.addEventListener('click', startBreathing);
            statsButton.addEventListener('click', showStatsModal);
            closeButton.addEventListener('click', closeStatsModal); // é‡æ–°ç»‘å®šå…³é—­æŒ‰é’®äº‹ä»¶
        };

        initApp(); // å¯åŠ¨åº”ç”¨

    });
    </script>
</body>
</html>